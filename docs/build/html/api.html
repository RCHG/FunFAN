

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>API reference &mdash; FunFAN 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Index" href="myindex.html" />
    <link rel="prev" title="References" href="references.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> FunFAN
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="set_functions.html">Set of Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="aerosols-psd.html">Examples aerosols-psd</a></li>
<li class="toctree-l1"><a class="reference internal" href="mie-scatt.html">Examples pymie_core</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#modules">Modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-aerosols_psd.lognormal">Aerosols PSD</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-aerosols_psd.binning">Binning of modal based climate diagnostics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-mie_scattering.pymie_core">Mie Scattering Spheres</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="myindex.html">Index</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">FunFAN</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>API reference</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="api-reference">
<h1>API reference<a class="headerlink" href="#api-reference" title="Permalink to this headline">¶</a></h1>
<p>This page provides an auto-generated summary of API. For more details
and examples, refer to the relevant chapters in the main part of the
documentation.</p>
<div class="section" id="modules">
<h2>Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
</div>
<div class="section" id="module-aerosols_psd.lognormal">
<span id="aerosols-psd"></span><h3>Aerosols PSD<a class="headerlink" href="#module-aerosols_psd.lognormal" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<div class="last line-block">
<div class="line"><strong>Program name</strong>      : lognormal.py</div>
<div class="line"><strong>Author</strong>            : Ramiro Checa-Garcia</div>
<div class="line"><strong>email</strong>             : <a class="reference external" href="mailto:rcheca&#37;&#52;&#48;lsce&#46;ipsl&#46;fr">rcheca<span>&#64;</span>lsce<span>&#46;</span>ipsl<span>&#46;</span>fr</a></div>
<div class="line"><strong>Purpose</strong>           : Functions related with lognormal aerosol distributions.</div>
<div class="line"><strong>Revision History</strong>  :</div>
<div class="line-block">
<div class="line">- Jan-2020   v1.0     Initial version. Contact: R.Checa</div>
</div>
</div>
</div>
<dl class="function">
<dt id="aerosols_psd.lognormal.Npdf_D">
<code class="descclassname">aerosols_psd.lognormal.</code><code class="descname">Npdf_D</code><span class="sig-paren">(</span><em>D</em>, <em>lnmu</em>, <em>lnsigma</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aerosols_psd/lognormal.html#Npdf_D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aerosols_psd.lognormal.Npdf_D" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Function for the pdf (probability density function)</dt>
<dd><img class="math" src="_images/math/35b3b5e37fd29f3b3e8748b366d2224194cdf1d3.png" alt="x^{*}(D)"/> such as <img class="math" src="_images/math/44a02c6485c340ba25996dc6db8b6565d3a226d9.png" alt="dX(D)=x^{*}(D; ln \mu, ln \sigma)dD"/></dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>D</strong> (<em>float</em>) – diameter value</li>
<li><strong>lnmu</strong> (<em>float</em>) – mean value as <img class="math" src="_images/math/5b2f89c15a21f2326165e8aad9abd1e108a3195b.png" alt="ln(\mu)"/></li>
<li><strong>lnsigma</strong> (<em>float</em>) – standard deviation as <img class="math" src="_images/math/c0260a0a6eacf2b50a72527e298c04fe35d7af2c.png" alt="ln(\sigma)"/></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Probability at diameter D (note about dD)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pdf (float)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="aerosols_psd.lognormal.Test">
<em class="property">class </em><code class="descclassname">aerosols_psd.lognormal.</code><code class="descname">Test</code><span class="sig-paren">(</span><em>methodName='runTest'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aerosols_psd/lognormal.html#Test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aerosols_psd.lognormal.Test" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="aerosols_psd.lognormal.Test.test_info_lognormal">
<code class="descname">test_info_lognormal</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/aerosols_psd/lognormal.html#Test.test_info_lognormal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aerosols_psd.lognormal.Test.test_info_lognormal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="aerosols_psd.lognormal.Xcdf_D">
<code class="descclassname">aerosols_psd.lognormal.</code><code class="descname">Xcdf_D</code><span class="sig-paren">(</span><em>D</em>, <em>lnmu</em>, <em>lnsigma</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aerosols_psd/lognormal.html#Xcdf_D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aerosols_psd.lognormal.Xcdf_D" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for the cdf (cumulative distribution function)
<img class="math" src="_images/math/3682eb2b1e357fefa559f438776314c51598b6ff.png" alt="X^{*}(D)"/> such as <img class="math" src="_images/math/a51c3a3cf0067fa4148b6d1f41443533a7e1fb66.png" alt="X(D)=\int_{0}^{D}x^{*}(y; ln \mu, ln \sigma)dy"/></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>D</strong> (<em>float</em>) – diameter value</li>
<li><strong>lnmu</strong> (<em>float</em>) – mean value as <img class="math" src="_images/math/5b2f89c15a21f2326165e8aad9abd1e108a3195b.png" alt="ln(\mu)"/></li>
<li><strong>lnsigma</strong> (<em>float</em>) – standard deviation as <img class="math" src="_images/math/c0260a0a6eacf2b50a72527e298c04fe35d7af2c.png" alt="ln(\sigma)"/></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Cumulative Probability Function from 0 to D.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">cdf (float)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="aerosols_psd.lognormal.Xpdf_logD">
<code class="descclassname">aerosols_psd.lognormal.</code><code class="descname">Xpdf_logD</code><span class="sig-paren">(</span><em>D</em>, <em>lnmu</em>, <em>lnsigma</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aerosols_psd/lognormal.html#Xpdf_logD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aerosols_psd.lognormal.Xpdf_logD" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Function for the pdf (probability density function)</dt>
<dd><img class="math" src="_images/math/35b3b5e37fd29f3b3e8748b366d2224194cdf1d3.png" alt="x^{*}(D)"/> such as <img class="math" src="_images/math/0e25f12c334f0ac85365810b6571fa0b57bbe1c0.png" alt="dX(D)=x^{*}(D; ln \mu, ln \sigma)dlnD"/></dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>D</strong> (<em>float</em>) – diameter value</li>
<li><strong>lnmu</strong> (<em>float</em>) – mean value as <img class="math" src="_images/math/5b2f89c15a21f2326165e8aad9abd1e108a3195b.png" alt="ln(\mu)"/></li>
<li><strong>lnsigma</strong> (<em>float</em>) – standard deviation as <img class="math" src="_images/math/c0260a0a6eacf2b50a72527e298c04fe35d7af2c.png" alt="ln(\sigma)"/></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Pprobability at diameter D (but note about dlnD, so we have actually a gaussian distribution).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pdf (float)</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Comment:</dt>
<dd><p class="first">This function is actually very general as:</p>
<blockquote>
<div><ul class="simple">
<li><img class="math" src="_images/math/b498527aad01e3d829dd69bf96f8ad4ede48d779.png" alt="dN(D)=n^{*}(D; ln \mu_{nmd}, ln \sigma)dlnD"/></li>
<li><img class="math" src="_images/math/4cc2a005b9129e46c82ef5fd3e3a61a30c6b68e2.png" alt="dA(D)=a^{*}(D; ln \mu_{amd}, ln \sigma)dlnD"/></li>
<li><img class="math" src="_images/math/a0502daedc5534abbf1e76d4af6318b54fb5a210.png" alt="dV(D)=v^{*}(D; ln \mu_{mmd}, ln \sigma)dlnD"/></li>
</ul>
</div></blockquote>
<p>where</p>
<blockquote class="last">
<div><ul class="simple">
<li><img class="math" src="_images/math/11b043d2ffe48eb01d4c40928b274d99063cb0b0.png" alt="\mu_{nmd}"/> (number median diameter)</li>
<li><img class="math" src="_images/math/079b6da67eea0d697b16e1e3d89fcd69733250da.png" alt="\mu_{amd}"/> (area   median diameter)</li>
<li><img class="math" src="_images/math/e95c276f6b11205e5312845328399b9707f59760.png" alt="\mu_{mmd}"/> (volume median diameter)</li>
</ul>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="aerosols_psd.lognormal.bin_fractions_lognormal">
<code class="descclassname">aerosols_psd.lognormal.</code><code class="descname">bin_fractions_lognormal</code><span class="sig-paren">(</span><em>xmd</em>, <em>sigma</em>, <em>bins</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aerosols_psd/lognormal.html#bin_fractions_lognormal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aerosols_psd.lognormal.bin_fractions_lognormal" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to estimate the bins fractions for given <img class="math" src="_images/math/7afa40b6918301e1bdee03ab884670a6804d1c8a.png" alt="\mu_{md}"/> and <img class="math" src="_images/math/011e5790a6c33043ceadca81d9657dde6c61d769.png" alt="\sigma"/>.
Note that <img class="math" src="_images/math/7afa40b6918301e1bdee03ab884670a6804d1c8a.png" alt="\mu_{md}"/> is usually <img class="math" src="_images/math/11b043d2ffe48eb01d4c40928b274d99063cb0b0.png" alt="\mu_{nmd}"/>, <img class="math" src="_images/math/079b6da67eea0d697b16e1e3d89fcd69733250da.png" alt="\mu_{amd}"/> or <img class="math" src="_images/math/e95c276f6b11205e5312845328399b9707f59760.png" alt="\mu_{mmd}"/>
It assumed a unit consistency between xmd and the bins values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xmd</strong> (<em>float</em>) – x median diameter</li>
<li><strong>sigma</strong> (<em>float</em>) – <img class="math" src="_images/math/011e5790a6c33043ceadca81d9657dde6c61d769.png" alt="\sigma"/> (not <img class="math" src="_images/math/738a79362827ee946e755363032fd4d3e3e62f06.png" alt="ln \sigma"/>).</li>
<li><strong>bins</strong> (<em>list</em>) – List of bin limits (no central values).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list with bins fraction between bin limits.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">lfractions (list)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="aerosols_psd.lognormal.lnmode">
<em class="property">class </em><code class="descclassname">aerosols_psd.lognormal.</code><code class="descname">lnmode</code><span class="sig-paren">(</span><em>ini_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aerosols_psd/lognormal.html#lnmode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aerosols_psd.lognormal.lnmode" title="Permalink to this definition">¶</a></dt>
<dd><p>Object with key information of an atmospheric particle lognormal mode
It is based on a dictionary used to build de object, this dictionary
has some fields as mandatory:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">sigma</span></code>  <img class="math" src="_images/math/011e5790a6c33043ceadca81d9657dde6c61d769.png" alt="\sigma"/> of lognormal mode (not <img class="math" src="_images/math/738a79362827ee946e755363032fd4d3e3e62f06.png" alt="ln \sigma"/>!!)</li>
<li><code class="docutils literal notranslate"><span class="pre">n_conc</span></code> number concentration</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code> name of mode</li>
<li><code class="docutils literal notranslate"><span class="pre">rhop</span></code> density particle</li>
</ul>
</div></blockquote>
<p>and one of these two:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">mmd</span></code>  mass median diameter</li>
<li><code class="docutils literal notranslate"><span class="pre">nmd</span></code>  number median diameter</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ini_dict</strong> (<em>dict</em>) – Dictionary with the main information to be used in the lognormal mode. It is mandatory that this dataset has the information indicated above.</td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ======= EXAMPLE of how to use (piece of code, not in REPL)</span>
<span class="c1">#</span>
<span class="c1"># (1) Create/Define the object here a lnmode named lnD1</span>
<span class="n">lnD1</span> <span class="o">=</span> <span class="n">lnmode</span><span class="p">({</span><span class="s1">&#39;sigma&#39;</span><span class="p">:</span> <span class="mf">1.8</span><span class="p">,</span> <span class="s1">&#39;mmd&#39;</span><span class="p">:</span><span class="mf">1.e-6</span><span class="p">,</span> <span class="s1">&#39;n_conc&#39;</span><span class="p">:</span><span class="mf">7e-6</span><span class="p">,</span> <span class="s1">&#39;rhop&#39;</span><span class="p">:</span><span class="mf">2650.0</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;D1&#39;</span><span class="p">})</span>

<span class="c1"># (2) How the statistics information of this mode</span>
<span class="n">lnD1</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># (3) Estimate the bin fractions for that distribution for mass distribution</span>
<span class="k">print</span><span class="p">(</span><span class="n">lnD1</span><span class="o">.</span><span class="n">bin_fractions</span><span class="p">([</span><span class="mf">0.001e-6</span><span class="p">,</span><span class="mf">1.0e-6</span><span class="p">,</span><span class="mf">2.e-6</span><span class="p">,</span><span class="mf">3.e-6</span><span class="p">]))</span>

<span class="c1"># (4) Estimate the bin fractions for that distribution for number distribution</span>
<span class="k">print</span><span class="p">(</span><span class="n">lnD1</span><span class="o">.</span><span class="n">bin_fractions</span><span class="p">([</span><span class="mf">0.001e-6</span><span class="p">,</span><span class="mf">1.0e-6</span><span class="p">,</span><span class="mf">2.e-6</span><span class="p">,</span><span class="mf">3.e-6</span><span class="p">]),</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;nmd&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="aerosols_psd.lognormal.lnmode.bin_fractions">
<code class="descname">bin_fractions</code><span class="sig-paren">(</span><em>bins</em>, <em>kind='mmd'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aerosols_psd/lognormal.html#lnmode.bin_fractions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aerosols_psd.lognormal.lnmode.bin_fractions" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the fraction of the distribution of each bin. We have an
object with mmd, nmd etc. So we have to be explicit about for which
distribution we want to calculate bin fractions (mmd, nmd etc).</p>
<p>NOTE: we have to be consistent between bins units and mmd/nmd units.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>bins</strong> (<em>list/array</em>) – List with all bin limits (no bins center values)</li>
<li><strong>kind</strong> (<em>str</em><em>, </em><em>optional</em>) – mmd or nmd. Defaults to ‘mmd’.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Freq/fraction per bin</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bin_frac (list)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="aerosols_psd.lognormal.lnmode.show">
<code class="descname">show</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/aerosols_psd/lognormal.html#lnmode.show"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aerosols_psd.lognormal.lnmode.show" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows the main properties of the lognormal mode</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="aerosols_psd.lognormal.plot_multimodal">
<code class="descclassname">aerosols_psd.lognormal.</code><code class="descname">plot_multimodal</code><span class="sig-paren">(</span><em>ax0</em>, <em>a_sigma</em>, <em>a_mmd</em>, <em>a_names</em>, <em>a_fact</em>, <em>nmodes</em>, <em>dmax=150.0</em>, <em>dmin=0.001</em>, <em>dinc=0.0005</em>, <em>rho=2650</em>, <em>nconc=7000000.0</em>, <em>ndist='v'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aerosols_psd/lognormal.html#plot_multimodal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aerosols_psd.lognormal.plot_multimodal" title="Permalink to this definition">¶</a></dt>
<dd><p>This function add a plot of a multimodal distribution ot the axes ax0,
the modes added are those defined by a_sigma and a_mmd but only using
the first nmodes in the array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ax0</strong> (<em>matplotlib axes</em>) – A matplotlib axes where draw the distribution</li>
<li><strong>a_sigma</strong> (<em>array</em>) – Array with the values of sigma of a multimodal lognormal.</li>
<li><strong>a_mmd</strong> (<em>array</em>) – Array with the values of the mass median diameter of all modes.</li>
<li><strong>a_names</strong> (<em>array</em>) – Array or list with the names of the modes.</li>
<li><strong>a_fact</strong> (<em>array</em>) – Array with fractions for each mode.</li>
<li><strong>nmodes</strong> (<em>array</em>) – Index (in the arrays above) of modes to use.</li>
<li><strong>dmax</strong> (<em>float</em><em>, </em><em>optional</em>) – Max diameter on plot. Defaults to 150.0</li>
<li><strong>dmin</strong> (<em>float</em><em>, </em><em>optional</em>) – Min diameter on plot. Defaults to 0.001</li>
<li><strong>dinc</strong> (<em>float</em><em>, </em><em>optional</em>) – resolution in diameter. Defaults to 0.0005</li>
<li><strong>rho</strong> (<em>float</em><em>, </em><em>optional</em>) – Density of the particles. Defaults to 2650</li>
<li><strong>nconc</strong> (<em>float</em><em>, </em><em>optional</em>) – Number concentration. Defaults to 7e6</li>
<li><strong>ndist</strong> (<em>string</em><em>, </em><em>optical</em>) – Name of distribution. Defaults to v.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">return the axes introduced and changed by the function.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ax0 (matplotlib axes)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="aerosols_psd.lognormal.stats_lognormal_mode">
<code class="descclassname">aerosols_psd.lognormal.</code><code class="descname">stats_lognormal_mode</code><span class="sig-paren">(</span><em>sigma</em>, <em>mmd</em>, <em>name</em>, <em>rhop=2650.0</em>, <em>n_conc=7000000.0</em>, <em>show=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aerosols_psd/lognormal.html#stats_lognormal_mode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aerosols_psd.lognormal.stats_lognormal_mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates, and optionally shows, the general info of an aerosol lognormal mode.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sigma</strong> (<em>float</em>) – Standard deviation of mode.</li>
<li><strong>mmd</strong> (<em>float</em>) – Mass median diameter.</li>
<li><strong>rhop</strong> (<em>float</em><em>, </em><em>optional</em>) – Density particles in mode. Defaults to 2650.0.</li>
<li><strong>n_conc</strong> (<em>float</em><em>, </em><em>optional</em>) – Number concentration. Defaults to 7e6</li>
<li><strong>show</strong> (<em>bool</em><em>, </em><em>optional</em>) – True to print in stdout. Defaults to True.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list with several statistics asociated to lognormal distr.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">out (list)</p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span># =======================================================================
# Typical output
#
# &gt; stats_lognormal_mode(1.8, 1e-6, &#39;D1&#39;, rhop=2650.0, n_conc=7.e6)

=========================================================================
*sigma  = 1.8000e+00  | *mmd   = 1.0000e-06 m   |=&gt; nmd    = 3.5470e-07 m
                      |=&gt; smd  = 7.0787e-07 m   |   smd!   = 7.0787e-07 m
 reff_n = 8.4135e-07  | reff_v = 5.0000e-07 m   |   reff_m = 5.0000e-07 m
 mmeand = 1.1886e-06  | nmoded = 2.5108e-07 m   |   d_avgm = 5.9557e-07 m
*n_conc = 7.0000e+06  | a_conc = 4.6456e-06 m   |   v_conc = 7.7427e-13 m
 m_conc = 2.0518e-09

*before word means pre-defined, ! after word means 2nd method
all others without symbols mean calculated
=========================================================================
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-aerosols_psd.binning">
<span id="binning-of-modal-based-climate-diagnostics"></span><h3>Binning of modal based climate diagnostics<a class="headerlink" href="#module-aerosols_psd.binning" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<div class="last line-block">
<div class="line"><strong>Program name</strong>      : binning.py</div>
<div class="line"><strong>Author</strong>            : Ramiro Checa-Garcia</div>
<div class="line"><strong>email</strong>             : <a class="reference external" href="mailto:rcheca&#37;&#52;&#48;lsce&#46;ipsl&#46;fr">rcheca<span>&#64;</span>lsce<span>&#46;</span>ipsl<span>&#46;</span>fr</a></div>
<div class="line"><strong>Purpose</strong>           : Functions to perform a binning of a modal based diagnostics</div>
<div class="line"><strong>Revision History</strong>  :</div>
<div class="line-block">
<div class="line">- Jan-2020   v1.0     Initial version. Contact: R.Checa</div>
</div>
</div>
</div>
<dl class="function">
<dt id="aerosols_psd.binning.create_netcdf_2D_bins">
<code class="descclassname">aerosols_psd.binning.</code><code class="descname">create_netcdf_2D_bins</code><span class="sig-paren">(</span><em>dic_fractions</em>, <em>dic_varname</em>, <em>dic_ncnames</em>, <em>modes</em>, <em>new_bins</em>, <em>dic_files</em>, <em>newvarname</em>, <em>ftest=None</em>, <em>save=True</em>, <em>test_info=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aerosols_psd/binning.html#create_netcdf_2D_bins"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aerosols_psd.binning.create_netcdf_2D_bins" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a netcdf of a given (lat,lon) diagnostic with values over a set of bins, given the
netcdfs over a set of modes for that diagnostics. The inputs are therefore a set
of netcdfs, one per mode, for a variable X(time, lat, lon) the output is a single netcdf with
X(time, lat, lon, bins).</p>
<p>For the calculation we need the expected fractions per bin for each mode. That can be calculated
with other functions provided in aerosols_psd set of functions.</p>
<p>With test_info the function can perform test of consistency.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dic_fractions</strong> (<em>dict</em>) – Dictionary for fractions per mode for new_bins.</li>
<li><strong>dic_varname</strong> (<em>dict</em>) – Dictionary variable-names on each mode diagnostic netcdf.</li>
<li><strong>dic_ncnames</strong> (<em>dict</em>) – Dictionary filenames of netcdf files per mode.</li>
<li><strong>modes</strong> (<em>list</em>) – Mode names (used as keys for dictionaries above).</li>
<li><strong>new_bins</strong> (<em>list</em>) – list or array with the bin limits.</li>
<li><strong>dic_files</strong> (<em>dict</em>) – Dictionary with info for output netcdf and base netcdf.</li>
<li><strong>newvarname</strong> (<em>str</em>) – New varname with diagnostic per bins.</li>
<li><strong>ftest</strong> (<em>file</em><em>, </em><em>optional</em>) – Save test on opened file ftest. Defaults to None.</li>
<li><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>) – Save netcdf (if not useful for test).
Defaults to True.</li>
<li><strong>test_info</strong> (<em>dict</em>) – kind of test, area is a datarray of area_grid if needed by test.
Defaults to None.
Example: {kind=’tendeny’, area=datarray, years=[‘2000’,‘2001’]}</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None. It saves a netcdf.</p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># EXAMPLE ================================================================</span>
<span class="c1"># Case with: modes named by A and B  -&gt; TWO MODES</span>
<span class="c1">#            bins = [0.1, 5.0, 10.0] -&gt; TWO BINS (three limits)</span>
<span class="c1">#</span>
<span class="n">modes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">]</span>
<span class="n">bins</span>  <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]</span>
<span class="n">dic_fractions</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]}</span>
<span class="n">dic_varname</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="s1">&#39;emidust&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="s1">&#39;emidust&#39;</span> <span class="p">}</span>
<span class="n">dic_ncnames</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="s1">&#39;emidust_modeA_mymodel.nc&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="s1">&#39;emidust_modeB_mymodel.nc&#39;</span> <span class="p">}</span>
<span class="n">dic_files</span>   <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;basedir&#39;</span><span class="p">:</span> <span class="s1">&#39;/home/myhome/mydirwithnc/&#39;</span><span class="p">,</span>
               <span class="s1">&#39;base_nc&#39;</span><span class="p">:</span> <span class="s1">&#39;my_canonical_netcdf.nc&#39;</span><span class="p">,</span>
               <span class="c1"># base_nc -&gt; It could be any of the dic_ncnames.</span>
               <span class="s1">&#39;base_var&#39;</span><span class="p">:</span> <span class="s1">&#39;emidust&#39;</span><span class="p">,</span>
               <span class="c1"># base_bar -&gt; It will be remove on save of binned file</span>
               <span class="s1">&#39;newf_nc&#39;</span><span class="p">:</span>  <span class="s1">&#39;emidust_BINNED.nc&#39;</span><span class="p">}</span>
<span class="n">newvarname</span>  <span class="o">=</span> <span class="s1">&#39;emidust_bins&#39;</span>

<span class="n">create_netcdf_emi_bins</span><span class="p">(</span><span class="n">dic_fractions</span><span class="p">,</span> <span class="n">dic_varname</span><span class="p">,</span> <span class="n">dic_ncnames</span><span class="p">,</span> <span class="n">modes</span><span class="p">,</span> <span class="n">new_bins</span><span class="p">,</span>
                       <span class="n">dic_files</span><span class="p">,</span>  <span class="n">newvarname</span><span class="p">,</span> <span class="n">ftest</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># (1) Read &#39;basedir + base_nc&#39; -&gt; copy from here the coords and dimensions of netcdf</span>
<span class="c1"># (2) Add the bins dimensions to the given structure</span>
<span class="c1"># (3) Open the files of dic_ncnames, for each file open the variable of dic_varname.</span>
<span class="c1"># (4) With these files and the dic_fractions estimate the binned 2D file.</span>
<span class="c1"># (5) As save=True it saved the netcdf with name newf_nc and variable name newvarname.</span>
<span class="c1">#</span>
<span class="c1"># For emissions or depositions it is a handy possibility to test consistency.</span>


<span class="n">f_area</span> <span class="o">=</span> <span class="s1">&#39;/home/myhome/mydirwithnc/area_grid.nc&#39;</span>
<span class="n">vararea</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">f_area</span><span class="p">)[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span>
<span class="n">mytest</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;testing_results.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">test_emi</span> <span class="o">=</span> <span class="p">{</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;tendency&#39;</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="n">vararea</span><span class="p">}</span>

<span class="n">create_netcdf_emi_bins</span><span class="p">(</span><span class="n">dic_fractions</span><span class="p">,</span> <span class="n">dic_varname</span><span class="p">,</span> <span class="n">dic_ncnames</span><span class="p">,</span> <span class="n">modes</span><span class="p">,</span> <span class="n">new_bins</span><span class="p">,</span>
                       <span class="n">dic_files</span><span class="p">,</span>  <span class="n">newvarname</span><span class="p">,</span> <span class="n">ftest</span><span class="o">=</span><span class="n">mytest</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                       <span class="n">test_info</span><span class="o">=</span><span class="n">test_emi</span><span class="p">)</span>

<span class="n">mytest</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="aerosols_psd.binning.test_tendency">
<code class="descclassname">aerosols_psd.binning.</code><code class="descname">test_tendency</code><span class="sig-paren">(</span><em>test_info</em>, <em>tendency_bins</em>, <em>new_bins</em>, <em>modes</em>, <em>basedir</em>, <em>dic_ncnames</em>, <em>dic_varname</em>, <em>ftest=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aerosols_psd/binning.html#test_tendency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aerosols_psd.binning.test_tendency" title="Permalink to this definition">¶</a></dt>
<dd><p>This function compares a binned diagnostic <img class="math" src="_images/math/60426060edb4268300cb6dd84bcdb552aa564f6f.png" alt="X(t, \phi, \zeta; b)"/> with the set of files per mode <img class="math" src="_images/math/0bb823c192de70e6181ad8beb9e1c0be885a42e4.png" alt="\{X_{m}(t, \phi, \zeta)\}"/>, where b is the set of bins.</p>
<p>It is assumed that test_info is of the form:
test_info = { kind=’tendency’, area=datarray, years=list of years as str}</p>
<p>For the calculation assumed a leap calendar and years with 365 days. Given that the test is
for consistency between modal and binned approaches last hypothesis is not important.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>test_info</strong> (<em>dict</em>) – Dictionary for fractions per mode for new_bins.</li>
<li><strong>tendency_bins</strong> (<em>datarray</em>) – Dictionary variable-names on each mode diagnostic netcdf.</li>
<li><strong>new_bins</strong> (<em>list</em>) – List or array with the bin limits.</li>
<li><strong>modes</strong> (<em>list</em>) – Mode names (used as keys for dictionaries above).</li>
<li><strong>dic_varname</strong> (<em>dict</em>) – Dictionary variable-names on each mode diagnostic netcdf.</li>
<li><strong>dic_ncnames</strong> (<em>dict</em>) – Dictionary filenames of netcdf files per mode.</li>
<li><strong>ftest</strong> (<em>file</em><em>, </em><em>optional</em>) – Save test on opened file ftest. Defaults to None.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None. Print on screen or save to file.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="aerosols_psd.binning.total_tendency">
<code class="descclassname">aerosols_psd.binning.</code><code class="descname">total_tendency</code><span class="sig-paren">(</span><em>tendency_data</em>, <em>area</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aerosols_psd/binning.html#total_tendency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aerosols_psd.binning.total_tendency" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the total tendency for a year
assuming a year with 365 days. Inputs are in SI, and outputs are
Tg per year.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tendency_data</strong> (<em>datarray</em>) – Datarray with a tendency field with monthly resolution, and SI units.</li>
<li><strong>area</strong> (<em>datarray</em>) – Datarray with the area per grid cell.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Total tendency per year in Tg.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tendency (float)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-mie_scattering.pymie_core">
<span id="mie-scattering-spheres"></span><h3>Mie Scattering Spheres<a class="headerlink" href="#module-mie_scattering.pymie_core" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<div class="last line-block">
<div class="line"><strong>Program name</strong>      : pymie_core.py</div>
<div class="line"><strong>Author</strong>            : Ramiro Checa-Garcia</div>
<div class="line"><strong>email</strong>             : <a class="reference external" href="mailto:r&#46;checagarcia&#37;&#52;&#48;gmail&#46;com">r<span>&#46;</span>checagarcia<span>&#64;</span>gmail<span>&#46;</span>com</a></div>
<div class="line"><strong>Purpose</strong>           : Functions related with mie scattering calculations</div>
<div class="line"><strong>Revision History</strong>  :</div>
<div class="line-block">
<div class="line">- Nov-2014   v1.0     Contact: R.Checa</div>
</div>
</div>
</div>
<dl class="class">
<dt id="mie_scattering.pymie_core.Test">
<em class="property">class </em><code class="descclassname">mie_scattering.pymie_core.</code><code class="descname">Test</code><span class="sig-paren">(</span><em>methodName='runTest'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mie_scattering/pymie_core.html#Test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mie_scattering.pymie_core.Test" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="mie_scattering.pymie_core.Test.test_mie_params_abs">
<code class="descname">test_mie_params_abs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mie_scattering/pymie_core.html#Test.test_mie_params_abs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mie_scattering.pymie_core.Test.test_mie_params_abs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="mie_scattering.pymie_core.Test.test_mie_params_noabs">
<code class="descname">test_mie_params_noabs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mie_scattering/pymie_core.html#Test.test_mie_params_noabs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mie_scattering.pymie_core.Test.test_mie_params_noabs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="mie_scattering.pymie_core.mie_complex_coef">
<code class="descclassname">mie_scattering.pymie_core.</code><code class="descname">mie_complex_coef</code><span class="sig-paren">(</span><em>x</em>, <em>m</em>, <em>n</em>, <em>method='Bessel'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mie_scattering/pymie_core.html#mie_complex_coef"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mie_scattering.pymie_core.mie_complex_coef" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Function to calculate Mie Complex Coeffients an and bn</em></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>float</em>) – mie size parameter</li>
<li><strong>m</strong> (<em>complex</em>) – complex refraction index</li>
<li><strong>n</strong> (<em>integer</em>) – order of an, bn</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p>mie complex coefficients <img class="math" src="_images/math/fa03a95629527383b245a2609fbc45a0124eb8b9.png" alt="(a_{n},b_{n})"/> of order n.</p>
<blockquote>
<div><ul class="simple">
<li>an (float): mie complex coefficient <img class="math" src="_images/math/c856b4c1eb6a502e59566f56ee311b62f75e4aae.png" alt="a_{n}"/></li>
<li>bn (float): mie complex coefficient <img class="math" src="_images/math/2dbb3895fd60e2da150ed1d87fb394a64737f6b3.png" alt="b_{n}"/></li>
</ul>
</div></blockquote>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tuple)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mie_scattering.pymie_core.mie_parameters">
<code class="descclassname">mie_scattering.pymie_core.</code><code class="descname">mie_parameters</code><span class="sig-paren">(</span><em>wavelenght</em>, <em>rad</em>, <em>m</em>, <em>langle</em>, <em>nmax=0</em>, <em>eps='1e-8'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mie_scattering/pymie_core.html#mie_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mie_scattering.pymie_core.mie_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p><em>This function calculate all the physical parameters</em></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>wavelenght</strong> (<em>float</em>) – Wavelenght</li>
<li><strong>rad</strong> (<em>float</em>) – Radius of the sphere</li>
<li><strong>m</strong> (<em>complex</em>) – Complex Refraction Index</li>
<li><strong>langle</strong> (<em>float</em>) – list of angles to calculate the phase matrix</li>
<li><strong>nmax</strong> (<em>float</em>) – Max number of terms to be included on Mie calculations. If
nmax=0 the number of terms are calculated to provided an
estimated accuracy of eps.</li>
<li><strong>eps</strong> (<em>float</em>) – By default it is 1e-8.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p>mie scattering optical parameters. Note that Fmat and Smat elements are themselves lists.</p>
<blockquote>
<div><ul class="simple">
<li>Qvec  (list): [Qsca, Qext, Qabs, Qbk, Qpr]</li>
<li>albe  (float): single scattering albedo</li>
<li>g_par (float): asymmetry g parameter</li>
<li>Cvec  (list): [Csca, Cext, Cabs]</li>
<li>Fmat  (list): [F11/Qsca, F12/Qsca, F33/Qsca, F34/Qsca]</li>
<li>Smat  (list): [S1, S2]</li>
</ul>
</div></blockquote>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tuple)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mie_scattering.pymie_core.vec_mie_angular">
<code class="descclassname">mie_scattering.pymie_core.</code><code class="descname">vec_mie_angular</code><span class="sig-paren">(</span><em>nmax</em>, <em>phi</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mie_scattering/pymie_core.html#vec_mie_angular"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mie_scattering.pymie_core.vec_mie_angular" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Function to calculate Mie Angular functions [1,NMAX]</em></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nmax</strong> (<em>integers</em>) – Order of the functions</li>
<li><strong>phi</strong> (<em>float</em>) – Scattering Angle [degrees]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p>mie-functions with indices 0 to nmax evaluated a <img class="math" src="_images/math/c2f31c22645274c375eff7920cfdfdc18d60341f.png" alt="\phi"/></p>
<blockquote>
<div><ul class="simple">
<li>l_mie_p (list): Mie-function [0, nmax] <img class="math" src="_images/math/870bb4fc631193699c128bdd91fb3008ebd8b5c3.png" alt="\pi_{k}"/> evaluated on <img class="math" src="_images/math/c2f31c22645274c375eff7920cfdfdc18d60341f.png" alt="\phi"/>.</li>
<li>l_mie_t (list): Mie-function [0, nmax] <img class="math" src="_images/math/53cc9c5966088782380642e46c77061ce18a0cdb.png" alt="\kappa_{k}"/> evaluated on <img class="math" src="_images/math/c2f31c22645274c375eff7920cfdfdc18d60341f.png" alt="\phi"/>.</li>
</ul>
</div></blockquote>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tuple)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="myindex.html" class="btn btn-neutral float-right" title="Index" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="references.html" class="btn btn-neutral float-left" title="References" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Ramiro Checa-Garcia

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>